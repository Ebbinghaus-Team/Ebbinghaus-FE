import{c as E,b as O,j as e,L as h,z as I,h as L,r as x,m as F,n as $}from"./index-CvvNVOg6.js";import{a as j}from"./date-C8p9obEE.js";import{R as _}from"./ReviewAddModal-BjqUVHE0.js";function U({group:a,codeCopied:i,onCopyCode:r}){const{data:t}=E(),{data:l}=O(),d=(t?.rooms?.length??0)>0,c=(l?.rooms?.length??0)>0,o=d||c;return e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx(h,{className:"text-gray-500 hover:text-gray-700",to:"/groups",children:e.jsx("i",{className:"ri-arrow-left-line text-xl"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:a.title})]}),e.jsx("p",{className:"text-gray-600",children:a.description})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:r,className:"inline-flex items-center justify-center font-medium rounded-lg transition-colors whitespace-nowrap cursor-pointer border border-gray-300 text-gray-700 hover:bg-gray-50 focus:ring-2 focus:ring-blue-500 px-4 py-2 text-base",children:i?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-check-line mr-2 text-green-600"}),"복사됨"]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-key-line mr-2"}),"초대 코드"]})}),e.jsx(h,{to:o?"/create":"#",onClick:m=>{o||(m.preventDefault(),I.error("개인/그룹 공부방이 없습니다. 먼저 공부방을 생성하세요."))},children:e.jsxs("button",{className:`inline-flex items-center justify-center font-medium rounded-lg transition-colors whitespace-nowrap cursor-pointer bg-blue-600 text-white hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 px-4 py-2 text-base ${o?"":"opacity-60 cursor-not-allowed"}`,children:[e.jsx("i",{className:"ri-add-line mr-2"}),"문제 만들기"]})})]})]})})}function z({totalQuestionSets:a,unsolvedQuestionSets:i,solvedQuestionSets:r}){return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 mb-1",children:a}),e.jsx("div",{className:"text-sm text-gray-600",children:"총 문제셋"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600 mb-1",children:i}),e.jsx("div",{className:"text-sm text-gray-600",children:"안 푼 문제셋"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600 mb-1",children:r}),e.jsx("div",{className:"text-sm text-gray-600",children:"푼 문제셋"})]})]})}function H({filters:a,activeFilter:i,onChange:r,getFilterCount:t}){return e.jsx("div",{className:"mt-6 mb-6",children:e.jsx("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg w-fit",children:a.map(l=>e.jsxs("button",{onClick:()=>r(l),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors whitespace-nowrap ${i===l?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[l," (",t(l),")"]},l))})})}function V({items:a,getStatusColor:i,onAfterSolveClick:r}){return e.jsx("div",{className:"space-y-4",children:a.map(t=>e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 text-xs font-medium rounded-full",children:t.description}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${i(t.status)}`,children:t.status}),t.isMyProblem&&e.jsx("span",{className:"px-2 py-1 bg-indigo-100 text-indigo-700 text-xs font-medium rounded-full",children:"내 문제"})]}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:t.title}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500 mb-2",children:[e.jsxs("span",{children:["출제자: ",t.author]}),e.jsxs("span",{children:["작성일: ",j(t.createdAt)]}),e.jsxs("span",{children:["복습 횟수: ",t.reviewCount,"회"]}),t.lastReviewedAt&&e.jsxs("span",{children:["마지막 복습: ",j(t.lastReviewedAt)]})]})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsx("div",{className:"flex space-x-2",children:e.jsx(h,{to:`/solve?id=${t.id}&from=group&isMy=${t.isMyProblem?"true":"false"}`,children:e.jsx("button",{className:"inline-flex items-center justify-center font-medium rounded-lg transition-colors whitespace-nowrap cursor-pointer bg-blue-600 text-white hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 px-4 py-2 text-base",onClick:()=>{setTimeout(()=>r(t),2e3)},children:t.status==="완료"?"다시 풀기":"문제 풀기"})})})})]})},t.id))})}function X({members:a}){const i=[...a].sort((r,t)=>r.isOwner===t.isOwner?0:r.isOwner?-1:1);return e.jsx("div",{className:"w-80 flex-shrink-0",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sticky top-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"그룹원"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[a.length,"명"]})]}),e.jsx("div",{className:"space-y-3 max-h-[calc(100vh-200px)] overflow-y-auto",children:i.map(r=>e.jsx("div",{className:"bg-gray-50 rounded-lg p-3 hover:bg-gray-100 transition-colors",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0",children:e.jsx("i",{className:"ri-user-line text-blue-600 text-xl"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 truncate",children:r.username}),r.isOwner&&e.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 text-blue-700 text-xs font-medium rounded",children:"방장"})]})})]})},r.userId))})]})})}const K=()=>{const{id:a}=L(),i=Number(a)||0,[r,t]=x.useState("전체"),[l,d]=x.useState(!1),[c,o]=x.useState(null),[m,g]=x.useState(!1),{data:n,isLoading:f}=F(i),{data:b,isLoading:y}=$(i),v=["전체","안 푼 문제","1차 관문","2차 관문","완료"],N=s=>s==="NOT_IN_REVIEW"?"안 푼 문제":s==="GATE_1"?"1차 관문":s==="GATE_2"?"2차 관문":s==="GRADUATED"?"완료":"안 푼 문제",w=s=>s==="MCQ"?"객관식":s==="OX"?"OX":s==="SHORT"?"단답형":s==="SUBJECTIVE"?"서술형":s,u=n?.problems.map(s=>({id:s.problemId,title:s.question,description:w(s.problemType),questionCount:1,author:s.creatorName,createdAt:s.createdAt,status:N(s.reviewGate),reviewCount:s.reviewCount,isMyProblem:s.isMyProblem,lastReviewedAt:s.lastReviewedAt}))??[],R=s=>s==="전체"?u.length:u.filter(D=>D.status===s).length,p=u.filter(s=>r==="전체"?!0:s.status===r),C=s=>{switch(s){case"안 푼 문제":return"bg-gray-100 text-gray-600";case"1차 관문":return"bg-orange-100 text-orange-600";case"2차 관문":return"bg-blue-100 text-blue-600";case"완료":return"bg-green-100 text-green-600";default:return"bg-gray-100 text-gray-600"}},A=s=>{o(s),d(!0)},G=()=>{d(!1),o(null)},k=()=>{d(!1),o(null)},Q=()=>{n&&(navigator.clipboard.writeText(n.joinCode),g(!0),setTimeout(()=>g(!1),2e3))};if(f||y||!n||!b)return e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"animate-pulse space-y-6",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"h-20 bg-gray-200 rounded"}),e.jsx("div",{className:"h-20 bg-gray-200 rounded"}),e.jsx("div",{className:"h-20 bg-gray-200 rounded"})]}),e.jsx("div",{className:"h-10 bg-gray-200 rounded w-1/2"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-24 bg-gray-200 rounded"}),e.jsx("div",{className:"h-24 bg-gray-200 rounded"}),e.jsx("div",{className:"h-24 bg-gray-200 rounded"})]})]})});const M={id:n.studyRoomId,title:n.studyRoomName,description:n.studyRoomDescription,code:n.joinCode},P=n.dashboard.totalCount,S=n.dashboard.unreviewedCount,T=n.problems.filter(s=>s.reviewGate==="GRADUATED").length;return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(U,{group:M,codeCopied:m,onCopyCode:Q}),e.jsx(z,{totalQuestionSets:P,unsolvedQuestionSets:S,solvedQuestionSets:T}),e.jsx(H,{filters:v,activeFilter:r,onChange:t,getFilterCount:R}),e.jsx(V,{items:p,getStatusColor:C,onAfterSolveClick:A}),p.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"ri-file-list-3-line text-4xl text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"해당 상태의 문제셋이 없습니다"}),e.jsx("p",{className:"text-gray-500",children:"다른 필터를 선택하거나 새로운 문제를 만들어보세요"})]})]}),e.jsx(X,{members:b.members})]}),e.jsx(_,{open:l&&!!c,title:c?.title??"",onSkip:k,onAdd:G})]})};export{K as default};
